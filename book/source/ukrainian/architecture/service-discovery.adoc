ifndef::imagesdir[:imagesdir: source/imgs/]

[#service-discovery]
=== Service Discovery

image::architecture/service-discovery.jpg[Service Discovery, align="center"]

[[service-discovery-definition]]*Service Discovery* ‚Äî —Ü–µ –º–µ—Ö–∞–Ω—ñ–∑–º, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —Ç–∞ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤—ñ—Å—ñ–≤ —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ Docker Swarm –∞–±–æ Kubernetes. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –≤–∞–∂–ª–∏–≤–æ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö, –¥–µ —Å–µ—Ä–≤—ñ—Å–∏ –º–æ–∂—É—Ç—å –¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É, –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏—Å—è –∞–±–æ –ø–µ—Ä–µ–º—ñ—â—É–≤–∞—Ç–∏—Å—è –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ –≤—É–∑–ª–∞–º–∏.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —É –≤–∞—Å —î —Å–µ—Ä–≤—ñ—Å–∏ _user-service_, _payment-service_ —Ç–∞ _email-service_, —ñ —Å–µ—Ä–≤—ñ—Å _payment-service_ —Ö–æ—á–µ –∑–≤‚Äô—è–∑–∞—Ç–∏—Å—è –∑ _user-service_, —Ç–æ –±–µ–∑ Service Discovery –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Ä—É—á–Ω—É –≤–∫–∞–∑—É–≤–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `http://192.168.0.15:8080`. –ê–ª–µ —è–∫—â–æ IP-–∞–¥—Ä–µ—Å–∞ –∑–º—ñ–Ω–∏—Ç—å—Å—è, _payment-service_ –±—ñ–ª—å—à–µ –Ω–µ –∑–º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ _user-service_. –ó–∞–≤–¥—è–∫–∏ Service Discovery _payment-service_ –º–æ–∂–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ _user-service_ –∑–∞ –π–æ–≥–æ –ª–æ–≥—ñ—á–Ω–æ—é –Ω–∞–∑–≤–æ—é: `http://user-service:8080`, —ñ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É IP-–∞–¥—Ä–µ—Å—É —Ç–∞ –ø–æ—Ä—Ç.

[[service-discovery-types]]
–û—Å–Ω–æ–≤–Ω—ñ —Ç–∏–ø–∏ *Service Discovery*:

* <<client-side-discovery,Client-side discovery>>;
* <<server-side-discovery,Server-side discovery>>;
* <<dns-based-discovery,DNS-based discovery>>;
* <<key-value-store-based-discovery,Key-Value Store-based discovery>>.


[[client-side-discovery]]
*Client-side discovery* (–∫–ª—ñ—î–Ω—Ç—Å—å–∫–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è) ‚Äî —Ü–µ –ø—ñ–¥—Ö—ñ–¥ –¥–æ Service Discovery, –ø—Ä–∏ —è–∫–æ–º—É –∫–ª—ñ—î–Ω—Ç (—Ç–æ–±—Ç–æ —Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π —Ö–æ—á–µ –∑–Ω–∞–π—Ç–∏ —ñ–Ω—à–∏–π —Å–µ—Ä–≤—ñ—Å) —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É, –æ—Ç—Ä–∏–º—É—î —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É —ñ –≤–∏–±–∏—Ä–∞—î, –¥–æ —è–∫–æ–≥–æ –∑ –Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∫–ª—ñ—î–Ω—Ç –Ω–µ –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–º—ñ–∂–Ω–∏–π –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤. –ü—Ä–∏–∫–ª–∞–¥–∞–º–∏ —Å–∏—Å—Ç–µ–º, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å client-side discovery, —î Netflix Eureka —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ Ribbon, –∞ —Ç–∞–∫–æ–∂ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ API Consul.

[[client-side-discovery-how-it-works]]
–Ø–∫ –ø—Ä–∞—Ü—é—î *Client-side discovery*:

1. –°–µ—Ä–≤—ñ—Å —Ä–µ—î—Å—Ç—Ä—É—î —Å–µ–±–µ –≤ —Å–µ—Ä–≤—ñ—Å–Ω–æ–º—É —Ä–µ—î—Å—Ç—Ä—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Eureka, Consul) –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É, –Ω–∞–¥–∞—é—á–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å–≤–æ—î —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è (IP-–∞–¥—Ä–µ—Å—É, –ø–æ—Ä—Ç, –º–µ—Ç–∞–¥–∞–Ω—ñ).
2. –ö–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —Å–µ—Ä–≤—ñ—Å —Ö–æ—á–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —ñ–Ω—à–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, –≤—ñ–Ω –∑–∞–ø–∏—Ç—É—î —Å–µ—Ä–≤—ñ—Å–Ω–∏–π —Ä–µ—î—Å—Ç—Ä, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É.
3. –ö–ª—ñ—î–Ω—Ç –æ—Ç—Ä–∏–º—É—î —Å–ø–∏—Å–æ–∫ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, round-robin, random) –¥–ª—è –≤–∏–±–æ—Ä—É –æ–¥–Ω–æ–≥–æ –∑ –Ω–∏—Ö.
4. –ö–ª—ñ—î–Ω—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –ø—Ä—è–º–µ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –æ–±—Ä–∞–Ω–∏–º —ñ–Ω—Å—Ç–∞–Ω—Å–æ–º —ñ –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç.
5. –Ø–∫—â–æ –æ–±—Ä–∞–Ω–∏–π —ñ–Ω—Å—Ç–∞–Ω—Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –∫–ª—ñ—î–Ω—Ç –º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É.

[source,java]
----
RestTemplate template = new RestTemplate();
String url = "http://user-service"; // –ª–æ–≥—ñ—á–Ω–µ —ñ–º‚Äô—è
----

Spring Cloud –∑ Eureka + Ribbon –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ IP.

[[client-side-discovery-pros-and-cons]]
–ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ *Client-side discovery*:

–ü–µ—Ä–µ–≤–∞–≥–∏:

* –ú–µ–Ω—å—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –ø—Ä–æ–º—ñ–∂–Ω—ñ –ø—Ä–æ–∫—Å—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –∫–ª—ñ—î–Ω—Ç —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–±–∏—Ä–∞—î —ñ–Ω—Å—Ç–∞–Ω—Å;
* –ì–Ω—É—á–∫—ñ—Å—Ç—å —É –≤–∏–±–æ—Ä—ñ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞;
* –ü—Ä—è–º–µ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —ñ —Å–µ—Ä–≤—ñ—Å–æ–º, —â–æ –º–æ–∂–µ –∑–Ω–∏–∑–∏—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫–∏.

–ù–µ–¥–æ–ª—ñ–∫–∏:

* –ö–æ–∂–µ–Ω –∫–ª—ñ—î–Ω—Ç –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Å–µ—Ä–≤—ñ—Å–Ω–∏–º —Ä–µ—î—Å—Ç—Ä–æ–º, —â–æ —É—Å–∫–ª–∞–¥–Ω—é—î –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –∫–æ–¥;
* –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ç–µ–∫–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Eureka ‚Üí Java only);
* –ü–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤—Å—ñ –∫–ª—ñ—î–Ω—Ç–∏ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –ª–æ–≥—ñ–∫–∏.

[[server-side-discovery]]
*Server-side discovery* (—Å–µ—Ä–≤–µ—Ä–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è) ‚Äî —Ü–µ –ø—ñ–¥—Ö—ñ–¥ –¥–æ Service Discovery, –ø—Ä–∏ —è–∫–æ–º—É –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —Å–µ—Ä–≤—ñ—Å –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ –ø—Ä–æ–º—ñ–∂–Ω–æ–≥–æ –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑—É, –∞ —Ü–µ–π –ø—Ä–æ–º—ñ–∂–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç –¥–æ —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É —Ç–∞ –ø–µ—Ä–µ—Å–ø—Ä—è–º–æ–≤—É—î –∑–∞–ø–∏—Ç –¥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —ñ–Ω—ÅÔøΩÔøΩ–∞–Ω—Å—É —Å–µ—Ä–≤—ñ—Å—É. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∫–ª—ñ—î–Ω—Ç –Ω–µ –º–∞—î –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É —ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –≤–∏–±—ñ—Ä —ñ–Ω—Å—Ç–∞–Ω—Å—É. –ü—Ä–∏–∫–ª–∞–¥–∞–º–∏ —Å–∏—Å—Ç–µ–º, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å server-side discovery, —î Kubernetes (—á–µ—Ä–µ–∑ kube-proxy —ñ DNS), Envoy —Ç–∞ Istio.

[[server-side-discovery-how-it-works]]
–Ø–∫ –ø—Ä–∞—Ü—é—î *Server-side discovery*:

1. –°–µ—Ä–≤—ñ—Å —Ä–µ—î—Å—Ç—Ä—É—î —Å–µ–±–µ –≤ —Å–µ—Ä–≤—ñ—Å–Ω–æ–º—É —Ä–µ—î—Å—Ç—Ä—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Kubernetes API Server, Consul) –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É, –Ω–∞–¥–∞—é—á–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å–≤–æ—î —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è (IP-–∞–¥—Ä–µ—Å—É, –ø–æ—Ä—Ç, –º–µ—Ç–∞–¥–∞–Ω—ñ).
2. –ö–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —Å–µ—Ä–≤—ñ—Å –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ –ø—Ä–æ–º—ñ–∂–Ω–æ–≥–æ –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑—É, –≤–∫–∞–∑—É—é—á–∏ –ª–æ–≥—ñ—á–Ω–µ —ñ–º‚Äô—è –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ DNS-—ñ–º‚Äô—è –∞–±–æ URL).
3. –ü—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑ –∑–∞–ø–∏—Ç—É—î —Å–µ—Ä–≤—ñ—Å–Ω–∏–π —Ä–µ—î—Å—Ç—Ä, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É.
4. –ü—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, round-robin, random) –¥–ª—è –≤–∏–±–æ—Ä—É –æ–¥–Ω–æ–≥–æ –∑ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤.
5. –ü—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –æ–±—Ä–∞–Ω–∏–º —ñ–Ω—Å—Ç–∞–Ω—Å–æ–º —ñ –ø–µ—Ä–µ—Å–ø—Ä—è–º–æ–≤—É—î –∑–∞–ø–∏—Ç –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞.
6. –Ø–∫—â–æ –æ–±—Ä–∞–Ω–∏–π —ñ–Ω—Å—Ç–∞–Ω—Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑ –º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É.

[source,java]
----
RestTemplate template = new RestTemplate();
String url = "http://gateway/user-service"; // —á–µ—Ä–µ–∑ API Gateway
----

API Gateway (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Zuul, Kong) –∞–±–æ —Å–µ—Ä–≤—ñ—Å–Ω–∞ —Å—ñ—Ç–∫–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Istio) –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ IP.

[[server-side-discovery-pros-and-cons]]
–ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ *Server-side discovery*:

–ü–µ—Ä–µ–≤–∞–≥–∏:

* –°–ø—Ä–æ—â–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ –∫–æ–¥—É, –æ—Å–∫—ñ–ª—å–∫–∏ –∫–ª—ñ—î–Ω—Ç –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –ª–æ–≥—ñ–∫–∏ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Å–µ—Ä–≤—ñ—Å–Ω–∏–º —Ä–µ—î—Å—Ç—Ä–æ–º;
* –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—î—é —Ç–∞ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑—É;
* –õ–µ–≥—à–µ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏, –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —ñ –ª–æ–≥—É–≤–∞–Ω–Ω—è –Ω–∞ —Ä—ñ–≤–Ω—ñ –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑—É.

–ù–µ–¥–æ–ª—ñ–∫–∏:

* –î–æ–¥–∞—Ç–∫–æ–≤–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –ø—Ä–æ–º—ñ–∂–Ω—ñ –ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑–∏, —â–æ –º–æ–∂–µ —Å—Ç–∞—Ç–∏ –≤—É–∑—å–∫–∏–º –º—ñ—Å—Ü–µ–º —É —Å–∏—Å—Ç–µ–º—ñ;
* –ó–∞—Ç—Ä–∏–º–∫–∏ —á–µ—Ä–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —ñ —Å–µ—Ä–≤—ñ—Å–æ–º;
* –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ –ø—Ä–æ–º—ñ–∂–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–ø—Ä–æ–∫—Å—ñ –∞–±–æ —à–ª—é–∑—É).

[[dns-based-discovery]]
*DNS-based discovery* (–≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ DNS) ‚Äî —Ü–µ –ø—ñ–¥—Ö—ñ–¥ –¥–æ Service Discovery, –ø—Ä–∏ —è–∫–æ–º—É —Å–µ—Ä–≤—ñ—Å–∏ –∑–Ω–∞—Ö–æ–¥—è—Ç—å –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é DNS-–∑–∞–ø–∏—Ç—ñ–≤. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∫–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å —Ä–µ—î—Å—Ç—Ä—É—î—Ç—å—Å—è –≤ DNS-—Å–∏—Å—Ç–µ–º—ñ –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º —ñ–º‚Äô—è–º, —ñ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ —Å–µ—Ä–≤—ñ—Å–∏ –º–æ–∂—É—Ç—å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—ñ —ñ–º–µ–Ω–∞. DNS-—Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–≤‚Äô—è–∑—É—î —Ü—ñ —ñ–º–µ–Ω–∞ –≤ –∞–∫—Ç—É–∞–ª—å–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Å–µ—Ä–≤—ñ—Å—ñ–≤. –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ Kubernetes (—á–µ—Ä–µ–∑ CoreDNS) —Ç–∞ Docker Swarm.

[[dns-based-discovery-how-it-works]]
–Ø–∫ –ø—Ä–∞—Ü—é—î *DNS-based discovery*:

1. –°–µ—Ä–≤—ñ—Å —Ä–µ—î—Å—Ç—Ä—É—î —Å–µ–±–µ –≤ DNS-—Å–∏—Å—Ç–µ–º—ñ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É, –Ω–∞–¥–∞—é—á–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–µ —ñ–º‚Äô—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `user-service.default.svc.cluster.local` —É Kubernetes).
2. –ö–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —Å–µ—Ä–≤—ñ—Å –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ —ñ–Ω—à–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –π–æ–≥–æ DNS-—ñ–º‚Äô—è.
3. DNS-—Å–∏—Å—Ç–µ–º–∞ —Ä–æ–∑–≤‚Äô—è–∑—É—î —Ü–µ —ñ–º‚Äô—è –≤ –∞–∫—Ç—É–∞–ª—å–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Å–µ—Ä–≤—ñ—Å—É.
4. –ö–ª—ñ—î–Ω—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –æ–¥–Ω–∏–º –∑ –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å —ñ –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç.
5. –Ø–∫—â–æ —ñ–Ω—Å—Ç–∞–Ω—Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –∫–ª—ñ—î–Ω—Ç –º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ DNS-–∑–∞–ø–∏—Ç, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å.

[source,java]
----
RestTemplate template = new RestTemplate();
String url = "http://user-service.default.svc.cluster.local"; // DNS-—ñ–º‚Äô—è
----

Kubernetes (—á–µ—Ä–µ–∑ CoreDNS) –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ IP.

[[dns-based-discovery-pros-and-cons]]
–ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ *DNS-based discovery*:

–ü–µ—Ä–µ–≤–∞–≥–∏:

* –®–∏—Ä–æ–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤ –±–∞–≥–∞—Ç—å–æ—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (Kubernetes, Docker Swarm);
* –ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ DNS —î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º —É –º–µ—Ä–µ–∂–∞—Ö;
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è IP-–∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ TTL –∑–∞–ø–∏—Å—ñ–≤ —É DNS.

–ù–µ–¥–æ–ª—ñ–∫–∏:

* –ó–∞—Ç—Ä–∏–º–∫–∏ —á–µ—Ä–µ–∑ DNS-–∑–∞–ø–∏—Ç–∏, –æ—Å–æ–±–ª–∏–≤–æ —è–∫—â–æ TTL –≤–∏—Å–æ–∫–∏–π —ñ –∑–∞–ø–∏—Å–∏ –Ω–µ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è —à–≤–∏–¥–∫–æ;
* –û–±–º–µ–∂–µ–Ω–∞ –≥–Ω—É—á–∫—ñ—Å—Ç—å —É –≤–∏–±–æ—Ä—ñ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π DNS-—Å–µ—Ä–≤–µ—Ä–∞);
* –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –∫–µ—à—É–≤–∞–Ω–Ω—è–º DNS –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç–∏ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö IP-–∞–¥—Ä–µ—Å.

[[key-value-store-based-discovery]]
*Key-Value Store-based discovery* (–≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å—Ö–æ–≤–∏—â–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è) ‚Äî —Ü–µ –ø—ñ–¥—Ö—ñ–¥ –¥–æ Service Discovery, –ø—Ä–∏ —è–∫–æ–º—É —Å–µ—Ä–≤—ñ—Å–∏ —Ä–µ—î—Å—Ç—Ä—É—é—Ç—å —Å–≤–æ—ó —ñ–Ω—Å—Ç–∞–Ω—Å–∏ –≤ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ–º—É —Å—Ö–æ–≤–∏—â—ñ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Consul, Etcd, Zookeeper). –ö–ª—ñ—î–Ω—Ç—Å—å–∫—ñ —Å–µ—Ä–≤—ñ—Å–∏ –∑–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è –¥–æ —Ü—å–æ–≥–æ —Å—Ö–æ–≤–∏—â–∞, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–æ—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Å—Ç–∞–Ω—Å–∏ —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤. –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –∑–∞–±–µ–∑–ø–µ—á—É—î –≤–∏—Å–æ–∫—É –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å —ñ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö –ø—Ä–æ —Å–µ—Ä–≤—ñ—Å–∏.

[[key-value-store-based-discovery-how-it-works]]
–Ø–∫ –ø—Ä–∞—Ü—é—î *Key-Value Store-based discovery*:

1. –°–µ—Ä–≤—ñ—Å —Ä–µ—î—Å—Ç—Ä—É—î —Å–µ–±–µ –≤ —Å—Ö–æ–≤–∏—â—ñ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É, —Å—Ç–≤–æ—Ä—é—é—á–∏ –∑–∞–ø–∏—Å –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –∫–ª—é—á–µ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `services/user-service/instance-id`) —ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º, —â–æ –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è (IP-–∞–¥—Ä–µ—Å—É, –ø–æ—Ä—Ç, –º–µ—Ç–∞–¥–∞–Ω—ñ).
2. –ö–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —Å–µ—Ä–≤—ñ—Å –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ —Å—Ö–æ–≤–∏—â–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É.
3. –ö–ª—ñ—î–Ω—Ç –æ—Ç—Ä–∏–º—É—î —Å–ø–∏—Å–æ–∫ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, round-robin, random) –¥–ª—è –≤–∏–±–æ—Ä—É –æ–¥–Ω–æ–≥–æ –∑ –Ω–∏—Ö.
4. –ö–ª—ñ—î–Ω—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –ø—Ä—è–º–µ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –æ–±—Ä–∞–Ω–∏–º —ñ–Ω—Å—Ç–∞–Ω—Å–æ–º —ñ –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç.
5. –Ø–∫—â–æ –æ–±—Ä–∞–Ω–∏–π —ñ–Ω—Å—Ç–∞–Ω—Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –∫–ª—ñ—î–Ω—Ç –º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ —Å—Ö–æ–≤–∏—â–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É.

[source,java]
----
RestTemplate template = new RestTemplate();
String url = "http://user-service"; // –ª–æ–≥—ñ—á–Ω–µ —ñ–º‚Äô—è
----

Consul API –∞–±–æ —ñ–Ω—à–∏–π –∫–ª—ñ—î–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ IP.

[[key-value-store-based-discovery-pros-and-cons]]
–ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ *Key-Value Store-based discovery*:

–ü–µ—Ä–µ–≤–∞–≥–∏:

* –í–∏—Å–æ–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å —ñ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö –ø—Ä–æ —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞–≤–¥—è–∫–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ–π –ø—Ä–∏—Ä–æ–¥—ñ —Å—Ö–æ–≤–∏—â –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è;
* –ì–Ω—É—á–∫—ñ—Å—Ç—å —É –≤–∏–±–æ—Ä—ñ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞;
* –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å–∫–ª–∞–¥–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, —Ç–∞–∫–∏—Ö —è–∫ health checks —ñ –º–µ—Ç–∞–¥–∞–Ω—ñ —Å–µ—Ä–≤—ñ—Å—ñ–≤.

–ù–µ–¥–æ–ª—ñ–∫–∏:

* –î–æ–¥–∞—Ç–∫–æ–≤–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—ñ —Å—Ö–æ–≤–∏—â–µ–º –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è;
* –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Å—Ö–æ–≤–∏—â–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è;
* –ü–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤—Å—ñ –∫–ª—ñ—î–Ω—Ç–∏ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –ª–æ–≥—ñ–∫–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑—ñ —Å—Ö–æ–≤–∏—â–µ–º.

[[service-discovery-types-comparison]]
|====
|–ö—Ä–∏—Ç–µ—Ä—ñ–π                   |Client-side|Server-side        |DNS-based              |KV Store-based
|–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ      |–í–∏—Å–æ–∫–∞     |–ù–∏–∑—å–∫–∞             |–ù–∏–∑—å–∫–∞                 |–í–∏—Å–æ–∫–∞
|–ü–æ—Ç—Ä—ñ–±–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–æ–∫—Å—ñ  |–ù—ñ         |–¢–∞–∫                |–ù—ñ                     |–ù—ñ
|–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É       |–ì–Ω—É—á–∫–µ     |–¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ     |–ë–∞–∑–æ–≤–µ (round-robin)   |–í—Ä—É—á–Ω—É –∞–±–æ –∑–æ–≤–Ω—ñ—à–Ω—î
|–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –º–æ–≤ / —Å—Ç–µ–∫—ñ–≤     |–û–±–º–µ–∂–µ–Ω–∞   |–ë—É–¥—å-—è–∫–∞           |–ë—É–¥—å-—è–∫–∞               |–ß–µ—Ä–µ–∑ SDK/API
|–ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –±—ñ–±–ª—ñ–æ—Ç–µ–∫   |–Ñ          |–í—ñ–¥—Å—É—Ç–Ω—è           |–í—ñ–¥—Å—É—Ç–Ω—è               |–Ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, gRPC+etcd)
|–ö–æ–Ω—Ç—Ä–æ–ª—å –∑ –±–æ–∫—É DevOps     |–°–∫–ª–∞–¥–Ω–æ    |–ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å    |–û–±–º–µ–∂–µ–Ω–æ               |–ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å
|–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å             |–í–∏—Å–æ–∫–∞     |–ù–∏–∂—á–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å—ñ |–í–∏—Å–æ–∫–∞                 |–í–∏—Å–æ–∫–∞ (–±–µ–∑ –ø—Ä–æ–∫—Å—ñ)
|====

Service Discovery –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –¥–≤–æ–º –∑ 2 –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π <<cap-theory,CAP-—Ç–µ–æ—Ä—ñ—ó>>:

1. –ë—É—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ (A), —â–æ–± –∫–ª—ñ—î–Ω—Ç–∏ –º–æ–≥–ª–∏ –∑–∞–≤–∂–¥–∏ –∑–Ω–∞–π—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Å–µ—Ä–≤—ñ—Å.
2. –ë—É—Ç–∏ —É–∑–≥–æ–¥–∂–µ–Ω–∏–º–∏ (C), —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ —Ñ–∞–ª—å—à–∏–≤–∏—Ö –∞–±–æ –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö –∑–∞–ø–∏—Å—ñ–≤.

–ê–ª–µ –ø—Ä–∏ –º–µ—Ä–µ–∂–µ–≤–æ–º—É —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—ñ (P), –¥–æ–≤–æ–¥–∏—Ç—å—Å—è –æ–±–∏—Ä–∞—Ç–∏:

* *Consul*/*Etcd*/*Zookeeper* ‚Äî> *CP —Å–∏—Å—Ç–µ–º–∏*: –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—ñ. –ö—Ä–∞—â–µ –∑—É–ø–∏–Ω–∏—Ç–∏ –∑–∞–ø–∏—Å, –Ω—ñ–∂ –¥–æ–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.
* **DNS-based discovery** ‚Äî> *AP —Å–∏—Å—Ç–µ–º–∏*: –∑–∞–≤–∂–¥–∏ –¥–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ—é (—á–µ—Ä–µ–∑ TTL, –∫–µ—à—É–≤–∞–Ω–Ω—è).

[[service-discovery-where-used]]
–î–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è *Service Discovery*:

* *Docker Swarm*: –º–∞—î –≤–±—É–¥–æ–≤–∞–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º Service Discovery, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–µ—Ä–≤—ñ—Å–∞–º –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ –∑–∞ —ñ–º–µ–Ω–∞–º–∏;
* *Kubernetes*: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–±—É–¥–æ–≤–∞–Ω—É DNS-—Å–∏—Å—Ç–µ–º—É (CoreDNS) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è —ñ–º–µ–Ω —Å–µ—Ä–≤—ñ—Å—ñ–≤;
* *Consul*, *Etcd*, *Zookeeper*: –∑–æ–≤–Ω—ñ—à–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ Service Discovery, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—ñ –∑ Docker, Kubernetes –∞–±–æ —ñ–Ω—à–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏;
* *AWS Cloud Map*, *Google Cloud Service Directory*: —Ö–º–∞—Ä–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—î—é —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è–º —Å–µ—Ä–≤—ñ—Å—ñ–≤ —É –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏—Ö —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö.

[[service-discovery-what-for]]
–©–æ –¥–∞—î *Service Discovery*:

* *–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è*: –∑–º–µ–Ω—à—É—î –ø–æ—Ç—Ä–µ–±—É –≤ —Ä—É—á–Ω–æ–º—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞–¥—Ä–µ—Å;
* *–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è*: –¥–µ—è–∫—ñ —Å–∏—Å—Ç–µ–º–∏ Service Discovery –º–æ–∂—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—è—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ –º—ñ–∂ –∫—ñ–ª—å–∫–æ–º–∞ —ñ–Ω—Å—Ç–∞–Ω—Å–∞–º–∏ —Å–µ—Ä–≤—ñ—Å—É;
* *Failover*: –∑–∞–±–µ–∑–ø–µ—á—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É —É –≤–∏–ø–∞–¥–∫—É –≤—ñ–¥–º–æ–≤–∏ –æ–¥–Ω–æ–≥–æ –∑ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Å–µ—Ä–≤—ñ—Å—É;
* *–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è*: –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —ñ–Ω—Å—Ç–∞–Ω—Å–∏ —Å–µ—Ä–≤—ñ—Å—É –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∫–ª—ñ—î–Ω—Ç—ñ–≤.

[[service-discovery-tools]]
–ü—Ä–∏–∫–ª–∞–¥–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ *Service Discovery*:

* *Docker Swarm*: –º–∞—î –≤–±—É–¥–æ–≤–∞–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º Service Discovery –Ω–∞ –æ—Å–Ω–æ–≤—ñ DNS;
* *Kubernetes DNS (CoreDNS)*: –≤–±—É–¥–æ–≤–∞–Ω–∞ DNS-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è —ñ–º–µ–Ω —Å–µ—Ä–≤—ñ—Å—ñ–≤ —É –∫–ª–∞—Å—Ç–µ—Ä—ñ;
* *Consul*: –ø–æ—Ç—É–∂–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è Service Discovery, health-check-—ñ–≤ —Ç–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π;
* *etcd*: —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–µ key-value —Å—Ö–æ–≤–∏—â–µ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Kubernetes –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∫–ª–∞—Å—Ç–µ—Ä–∞, –≤–∫–ª—é—á–Ω–æ –∑ –¥–∞–Ω–∏–º–∏ –¥–ª—è Service Discovery;
* *Zookeeper*: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º —ñ —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º Service Discovery (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É Kafka, Hadoop);
* *Eureka*: —Å–µ—Ä–≤—ñ—Å–Ω–∏–π —Ä–µ—î—Å—Ç—Ä, —è–∫–∏–π —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –µ–∫–æ—Å–∏—Å—Ç–µ–º—ñ Spring Cloud.

[[service-discovery-main-components]]
–ì–æ–ª–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ *Service Discovery*:

* *–†–µ—î—Å—Ç—Ä–∞—Ç–æ—Ä —Å–µ—Ä–≤—ñ—Å—ñ–≤ (Service Registrar)*: –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é –Ω–æ–≤–∏—Ö —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Å–µ—Ä–≤—ñ—Å—É –≤ —Ä–µ—î—Å—Ç—Ä—ñ —Ç–∞ —ó—Ö –≤–∏–¥–∞–ª–µ–Ω–Ω—è —É —Ä–∞–∑—ñ –∑—É–ø–∏–Ω–∫–∏ –∞–±–æ –∑–±–æ—é;
* *–°–µ—Ä–≤—ñ—Å (Service)*: –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –∞–±–æ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π —Ä–µ—î—Å—Ç—Ä—É—î—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º—ñ Service Discovery;
* *–ö–ª—ñ—î–Ω—Ç Service Discovery*: –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–∞–±–æ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞), —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —Å–µ—Ä–≤—ñ—Å–∞–º –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —ñ–Ω—à—ñ —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞ —ó—Ö –ª–æ–≥—ñ—á–Ω–∏–º–∏ —ñ–º–µ–Ω–∞–º–∏;
* *Health Checks*: –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞–Ω—É —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Å–µ—Ä–≤—ñ—Å—ñ–≤, —è–∫—ñ –≥–∞—Ä–∞–Ω—Ç—É—é—Ç—å, —â–æ –∫–ª—ñ—î–Ω—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –ª–∏—à–µ –∑ –ø—Ä–∞—Ü–µ–∑–¥–∞—Ç–Ω–∏–º–∏ —ñ–Ω—Å—Ç–∞–Ω—Å–∞–º–∏;
* *–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø—É (DNS –∞–±–æ API)*: —Å–ø–æ—Å—ñ–±, —á–µ—Ä–µ–∑ —è–∫–∏–π –∫–ª—ñ—î–Ω—Ç–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–æ—Å—Ç—É–ø–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ DNS-—ñ–º–µ–Ω–∞ –∞–±–æ REST/gRPC API).



















‚úÖ 4. Service Discovery vs API Gateway vs Service Mesh

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç	–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
Service Discovery	–ó–Ω–∞—Ö–æ–¥–∏—Ç—å —ñ–Ω—Å—Ç–∞–Ω—Å–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤
API Gateway	–í–∏—Å—Ç—É–ø–∞—î —î–¥–∏–Ω–æ—é —Ç–æ—á–∫–æ—é –≤—Ö–æ–¥—É –¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤
Service Mesh	–ö–æ–Ω—Ç—Ä–æ–ª—é—î —Ç—Ä–∞—Ñ—ñ–∫ –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ L7 (—á–∞—Å—Ç–æ –≤ —Ç–∞–Ω–¥–µ–º—ñ –∑ discovery)

‚û°Ô∏è –ü–æ—è—Å–Ω–∏, —á–æ–º—É Service Mesh (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Istio, Linkerd) –Ω–µ –∑–∞–º—ñ–Ω—é—î, –∞ –¥–æ–ø–æ–≤–Ω—é—î Service Discovery.

‚∏ª

‚úÖ 5. Failure Scenarios & Resilience
‚Ä¢	–©–æ –±—É–¥–µ, —è–∫—â–æ –∑–Ω–∏–∫–Ω–µ –≤–µ—Å—å –∫–ª–∞—Å—Ç–µ—Ä Consul?
‚Ä¢	–Ø–∫ Kubernetes –≤—ñ–¥–Ω–æ–≤–ª—é—î DNS CoreDNS pod?
‚Ä¢	–Ø–∫ –±—É–¥—É–≤–∞—Ç–∏ circuit breakers, retries, timeouts –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ Service Discovery?

‚∏ª

‚úÖ 6. –†–æ–ª—å DNS —É Service Discovery
‚Ä¢	–ß–∏–º DNS-–±–∞–∑–æ–≤–∞–Ω–∏–π discovery –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ API?
‚Ä¢	–©–æ —Ç–∞–∫–µ SRV-–∑–∞–ø–∏—Å–∏? –Ø–∫ –ø—Ä–∞—Ü—é—î dnsRoundRobin?
‚Ä¢	TTL-–∑–∞–ª–µ–∂–Ω–∞ –∫–µ—à–æ–≤–∞–Ω—ñ—Å—Ç—å: –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ stale-–∑–∞–ø–∏—Å–∞—Ö

‚∏ª

‚úÖ 7. –ë–µ–∑–ø–µ–∫–∞ Discovery
‚Ä¢	–•—Ç–æ –º–æ–∂–µ —Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏?
‚Ä¢	–ú–æ–∂–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Ñ–µ–π–∫–æ–≤–∏–π auth-service?
‚Ä¢	–Ø–∫ –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ Registry? (mTLS, ACL, JWT)

‚∏ª

‚úÖ 8. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑ –¥–æ—Å–≤—ñ–¥–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

üéØ Senior –º–∞—î —Ö–æ—á–∞ –± –±–∞–∑–æ–≤–∏–π –ø—Ä–æ–¥–∞–∫—à–Ω-–¥–æ—Å–≤—ñ–¥ –∑ –æ–¥–Ω–∏–º —ñ–∑:

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç	–©–æ —Ç—Ä–µ–±–∞ –∑–Ω–∞—Ç–∏
Consul	ACL, DNS, health checks, sync modes
Eureka	Self-preservation mode, client cache
Kubernetes	CoreDNS, headless services, SRV-–∑–∞–ø–∏—Å–∏
Zookeeper	ZNode, ephemeral nodes, leader election


‚∏ª

‚úÖ 9. –ö–ª–∞—Å–∏—á–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è –∑ —ñ–Ω—Ç–µ—Ä–≤‚Äô—é
‚Ä¢	–ü–æ—è—Å–Ω–∏ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ client-side —ñ server-side discovery.
‚Ä¢	–Ø–∫ —Ç–∏ —Ä–µ–∞–ª—ñ–∑—É—î—à zero-downtime deployment, —è–∫—â–æ IP –∑–º—ñ–Ω—é—î—Ç—å—Å—è?
‚Ä¢	–©–æ –±—É–¥–µ, —è–∫—â–æ –æ–¥–∏–Ω –∑ —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤ —Å–µ—Ä–≤—ñ—Å—É –Ω–µ –ø—Ä–∞—Ü—é—î, –∞–ª–µ —â–µ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π?
‚Ä¢	–ß–∏–º Kubernetes service discovery –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ Eureka/Consul?

‚∏ª

‚úÖ 10. –¢–µ—Å—Ç–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è –∞–±–æ whiteboard:

‚Äú–†–æ–∑—Ä–æ–±–∏ —Å–∏—Å—Ç–µ–º—É, —è–∫–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –¥–æ–¥–∞—î —ñ –≤–∏–¥–∞–ª—è—î —ñ–Ω—Å—Ç–∞–Ω—Å–∏ —Å–µ—Ä–≤—ñ—Å—É –ø—Ä–∏ –∞–≤—Ç–æ—Å–∫–µ–π–ª—ñ–Ω–≥—É. –ö–ª—ñ—î–Ω—Ç–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –∑–Ω–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å–∏. –Ø–∫ –±—É–¥–µ—à —Ü–µ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏?‚Äù

‚∏ª

–•–æ—á–µ—à ‚Äî –º–æ–∂—É —Å–∫–ª–∞—Å—Ç–∏ –¥–ª—è —Ç–µ–±–µ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π ‚ÄúService Discovery Interview Pack‚Äù:
‚Ä¢	20+ –ø–∏—Ç–∞–Ω—å
‚Ä¢	–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ
‚Ä¢	cheat sheet
‚Ä¢	mini-–ø—Ä–æ–µ–∫—Ç–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –∑–Ω–∞–Ω—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Eureka + 2 –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏)

–ì–æ—Ç–æ–≤–∏–π –∑—Ä–æ–±–∏—Ç–∏ –ø—Ä—è–º–æ –∑–∞—Ä–∞–∑.

