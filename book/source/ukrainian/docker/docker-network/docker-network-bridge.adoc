ifndef::imagesdir[:imagesdir: ../../../imgs/]

[#docker-network-bridge]
==== Bridge Network

image::docker/docker-network-bridge.jpg[Docker Bridge Network, align="center"]

[[docker-network-bridge-definition]]Мережа `bridge` є мережею, яка створюється Docker за замовчуванням. Створюється мост (docker0) на хосте, контейнери під'єднуються до нього що дозволяє контейнерам на одному хості спілкуватися між собою. Кожен контейнер отримує власну IP-адресу в межах цієї мережі. Це забезпечує ізоляцію між контейнерами, але дозволяє їм спілкуватися один з одним через IP-адреси або імена хостів (вони ж назви контейнерів).

[[docker-network-bridge-main-properties]]
Основні властивості мережі `bridge`:

* Кожен контейнер отримує власну приватну IP-адресу у віртуальній мережі;
* Спілкування між контейнерами в одній мережі bridge відбувається напряму;
* Для доступу ззовні використовуються механізми <<network-address-translation,NAT>> та проброс портів (-p);
* <<domain-name-system,DNS>>-розв’язання для імен контейнерів підтримується всередині user-defined bridge;
* Існує базова мережева ізоляція між контейнерами та хостом, а також між контейнерами з різних bridge-мереж.

[[docker-network-bridge-usage]]
Мережа `bridge` використовується в наступних випадках:

* *Ізольоване середовище для сервісів*: Наприклад, backend і база даних в одному docker-compose, які спілкуються між собою;
* *Тестування сервісів*: Простий спосіб підняти кілька взаємопов’язаних контейнерів для локального тестування;
* *Контейнери за замовчуванням*: При створенні контейнера без явно вказаної мережі, Docker підключає його до default bridge network.

[[docker-network-bridge-pros-and-cons]]
`Bridge` pros and cons:

Pros:

* *Ізоляція*: Контейнери ізольовані від хосту та інших bridge-мереж;
* *Гнучкість*: Можна створювати власні bridge-мережі та керувати <<domain-name-system,DNS>>, alias-ами та правилами доступу;
* *Масштабованість*: Підходить для роботи з кількома контейнерами на одному хості;
* *Безпечніше, ніж host*, оскільки порти не відкриті на хості за замовчуванням.

Cons:

* *Затримка*: Трохи вища, ніж у режимі host, через використання <<network-address-translation,NAT>>;
* *Неінтуїтивність для новачків*: Потрібен проброс портів для доступу до сервісів ззовні;
* *Конфігурація <<domain-name-system,DNS>> обмежена в default bridge*: Для розширених можливостей треба створювати user-defined bridge network;
* *Обмежене спілкування між bridge-мережами*, якщо не налаштоване вручну (через iptables або зовнішній proxy).

[[docker-network-bridge-problem]]
Потенційні проблеми з режимом `bridge`:

* Контейнери не можуть спілкуватися між bridge-мережами без додаткової конфігурації;
* Можуть виникати конфлікти портів при пробросі, якщо декілька контейнерів намагаються використовувати один і той же порт на хості;
* Якщо неправильно налаштовані правила <<network-address-translation,NAT>>, зовнішній трафік може не доходити до контейнера;
* Проблеми з <<domain-name-system,DNS>>-розв’язанням у default bridge, якщо покладатися лише на імена контейнерів.

[[docker-network-bridge-main-features]]
Головні особливості мережі `bridge`:

* Тип мережі за замовчуванням для контейнерів у Docker;
* Ідеально підходить для невеликих або середніх проєктів з локальним мережевим зв’язком між контейнерами;
* Забезпечує базову ізоляцію, баланс між безпекою та зручністю;
* Для складніших кейсів — рекомендовано створювати user-defined bridge network, яка підтримує повноцінний <<domain-name-system,DNS>>, alias-и, контроль доступу.

[[docker-network-bridge-user-defined-bridge-network]]
*User-defined bridge network* — це мережа, створена користувачем за допомогою команди `docker network create --driver bridge <network-name>`. Вона має більше можливостей, ніж default bridge network, яку Docker створює автоматично.

[[docker-network-bridge-user-defined-bridge-network-definition]]
`User-defined bridge` network — це кастомна мережа типу bridge, яка забезпечує:

* *Кращу ізоляцію між контейнерами*: контейнери в різних user-defined bridge мережах не можуть спілкуватися між собою без додаткової конфігурації;
* Автоматичне <<domain-name-system,DNS>>-розв’язання імен контейнерів;
* Можливість вказувати aliases (псевдоніми);
* Гнучке управління з’єднаннями між контейнерами.

[[docker-network-bridge-user-defined-bridge-vs-default]]
Відмінності від `default bridge` network:

|====
|Функція|default bridge|user-defined bridge
|DNS-розв’язання по імені контейнера|Немає|Є
|Автоматичне з’єднання|Немає|Можна з’єднати по імені
|Псевдоніми (aliases)|Немає|Можна вказувати
|Більше контролю|Мінімальний|Повний контроль
|Мережева ізоляція між bridge-мережами|Є|Є
|====

[[docker-network-bridge-user-defined-bridge-usage]]
Навіщо використовувати `user-defined bridge`:

* Коли потрібно, щоб декілька контейнерів легко “бачили” один одного по імені;
* Для docker-compose, який автоматично створює таку мережу;
* Коли потрібна краща безпека та контроль ізоляції;
* Для налаштування складніших топологій без host або macvlan.
