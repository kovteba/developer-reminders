ifndef::imagesdir[:imagesdir: ../../../imgs/]

[#docker-network-host]
==== Host Network

image::docker/docker-network-host.jpg[Docker Host Network, align="center"]

[[docker-network-host-definition]]`Host` — це тип мережі при якому контейнер не має власної IP-адреси, а використовуватиме IP-адресу хоста. Контейнер не матиме власної IP-адреси, а використовуватиме IP-адресу хоста. Це може бути корисно для високопродуктивних застосунків покращуючи продуктивність, але знижує рівень ізоляції контейнерів.

[[docker-network-host-main-properties]]
Основні властивості мережі `host`:

* Контейнер не має власної IP-адреси, а використовує IP-адресу хоста;
* Контейнер відкриває порти напряму на хості, без використання <<network-address-translation,NAT>>;
* Контейнер використовує <<domain-name-system,DNS>> хоста, що дозволяє йому спілкуватися з іншими контейнерами та зовнішнім світом без <<network-address-translation,NAT>>;
* Відсутня мережева ізоляція між контейнером та хостом;

[[docker-network-host-usage]]
Мережа `host` використовується в наступних випадках:

1. Максимальна продуктивність: коли важлива швидкість та низька затримка, наприклад, для високопродуктивних застосунків або сервісів, які потребують швидкого доступу до мережі;
2. Моніторинг та метрик: Наприклад, Prometheus node_exporter або cadvisor — їм потрібно мати доступ до всієї системи;
3. Тестування локальних мереж: коли потрібно тестувати мережеві застосунки на локальному хості без використання <<network-address-translation,NAT>>;

[[docker-network-host-pros-and-cons]]
`Host` pros and cons:

Pros:

* *Відсутність <<network-address-translation,NAT>>*, прямий доступ до мережі, немає прокидання портів (-p);
* *Низька затримка (latency)*, оскільки немає додаткового рівня абстракції між контейнером та хостом;
* *Контейнер має повний доступ до мережі хоста*, що дозволяє йому спілкуватися з іншими контейнерами та зовнішнім світом без <<network-address-translation,NAT>>;
* *Простота інтеграції з системами*, які не підтримують Docker networking, оскільки контейнер використовує мережу хоста.

Cons:

* *Втрата ізоляції* між контейнером та хостом, що може призвести до проблем з безпекою;
* *Конфлікти портів*, якщо порт вже зайнятий хостом, контейнер не стартує;
* *Безпека*: зловмисний код в контейнері має повний мережевий доступ до хоста, що може призвести до компрометації системи;
* *Не підтримується на Mac/Windows*: оскільки для Docker Desktop імітує мережу, але режим `host` там не працює. В Linux режим `host` дозволяє контейнеру безпосередньо використовувати мережевий стек хост-машини, що означає, що контейнер бачить ті ж мережеві інтерфейси, IP-адреси та порти, що і хост. На macOS/Windows Docker працює через віртуальну машину, (наприклад, Hyper-V на Windows або Docker Desktop на macOS), тому контейнери, запущені в цій віртуальній машині, не мають прямого доступу до мережевого стеку хост-машини. Спроба використання режиму `host` на macOS/Windows призведе до того, що контейнер не зможе отримати доступ до мережевих ресурсів хоста або, навпаки, хост не зможе безпосередньо звернутися до ресурсів контейнера. Тому для досягнення бажаної функціональності потрібно використовувати альтернативний підхід, наприклад, використання пробросу портів або налаштування мережі через віртуальну машину;
* *Ускладнення налаштувань firewall/iptables*, оскільки контейнер не відрізняється від інших системних процесів.

[[docker-network-host-problem]]
Потенційні проблеми з режимом `host`:

* Конфлікти портів з хост-системою, оскільки контейнери використовують порти хоста без <<network-address-translation,NAT>>;
* Відсутність мережевої ізоляції, що може призвести до проблем з безпекою;
* Складніше управляти безпекою, оскільки контейнер фактично "бачить" все, що є на хості.

[[docker-network-host-main-features]]
Головні особливості мережі `host`:

* Висока продуктивність, оскільки немає додаткового рівня абстракції між контейнером та хостом;
* Контейнер може отримувати доступ до всіх мережевих інтерфейсів хоста;
* Використовується для високопродуктивних застосунків, де важлива швидкість та низька затримка.
